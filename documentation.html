<!DOCTYPE html>
<html>
<head>
    <title>SecureFileDelete Technical Documentation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.5;
            padding: 20px;
        }

        h1 {
            font-size: 24px;
        }

        h2 {
            font-size: 20px;
        }

        pre {
            background-color: #f7f7f7;
            padding: 10px;
            overflow: auto;
        }

        code {
            font-family: Consolas, monospace;
        }
    </style>
</head>
<body>
    <h1>SecureFileDelete Technical Documentation</h1>

    <h2>Introduction</h2>
    <p>
        This document provides technical documentation for the SecureFileDelete application.
        SecureFileDelete is a command-line tool designed to securely delete files from a specified folder.
    </p>

    <h2>Code Overview</h2>
    <p>
        The SecureFileDelete application is implemented in C#. It consists of a single class named <code>SecureFileDelete</code>.
        The class contains various methods for performing secure file deletion based on the provided command-line arguments.
    </p>

    <h2>Usage</h2>
    <pre><code>
        Usage: safedelete --folder &lt;folder_path&gt; [--time_limit &lt;minutes&gt;] [--pattern &lt;file_pattern&gt;] [--exclude_files &lt;file1,file2,...&gt;] [--recursive]
               safedelete -f &lt;folder_path&gt; [-t &lt;minutes&gt;] [-p &lt;file_pattern&gt;] [-e &lt;file1,file2,...&gt;] [-r]

        Parameters:
          --folder, -f          : The path of the folder to delete files from. (required)
          --time_limit, -t      : The time limit (in minutes) specifying the maximum file age. (optional)
          --pattern, -p         : The file name pattern to match. (optional)
          --exclude_files, -e   : Comma-separated list of files to exclude from deletion. (optional)
          --recursive, -r       : Search for files in all subfolders. (optional)
          --no_prompt, -np      : Enable no prompt mode. Files will be securely deleted without confirmation. (optional)
          --simulate, -s        : Enable simulate mode. Files will not be securely deleted, they will be simulated. (optional)
          --help, -h            : Display usage information. (optional)
    </code></pre>

    <h2>Code Documentation</h2>
    <h3>Class: SecureFileDelete</h3>

    <h4>Methods</h4>
    <ul>
        <li>
            <code>Main(string[] args)</code>
            <p>The entry point of the application. Parses command-line arguments and performs secure file deletion.</p>
        </li>
        <li>
            <code>Usage()</code>
            <p>Displays the usage information and available parameters.</p>
        </li>
        <li>
            <code>PerformSecureFileDeletion(CommandLineArguments arguments)</code>
            <p>Performs secure file deletion based on the provided command-line arguments.</p>
        </li>
        <li>
            <code>ParseArguments(string[] args)</code>
            <p>Parses the command-line arguments and returns a <code>CommandLineArguments</code> object.</p>
        </li>
        <li>
            <code>PerformSecureFileDeletion(string folder, int? timeLimit, string pattern, List&lt;string&gt; excludeFiles, bool recursive, bool noPromptMode, bool simulate)</code>
            <p>Performs secure file deletion with the specified parameters.</p>
        </li>
        <li>
            <code>ProcessFolder(DirectoryInfo folder, List&lt;FileInfo&gt; files, int? timeLimit, string pattern, List&lt;string&gt; excludeFiles, SearchOption searchOption)</code>
            <p>Recursively processes a folder and collects files matching the specified criteria.</p>
        </li>
        <li>
            <code>UpdateProgressBar(int currentFilesDeleted, int totalFiles)</code>
            <p>Updates the progress bar during file deletion.</p>
        </li>
        <li>
            <code>DeleteEmptySubfolders(string rootFolder)</code>
            <p>Deletes empty subfolders within the specified root folder.</p>
        </li>
        <li>
            <code>SecureDeleteFile(string filePath)</code>
            <p>Performs secure deletion of a file by overwriting its content with random and null values.</p>
        </li>
        <li>
            <code>OverwriteWithRandomData(FileStream stream, long fileSize)</code>
            <p>Overwrites a file stream with random data.</p>
        </li>
        <li>
            <code>OverwriteWithNullValues(FileStream stream, long fileSize)</code>
            <p>Overwrites a file stream with null values.</p>
        </li>
        <li>
            <code>OverwriteWithZeroValues(FileStream stream, long fileSize)</code>
            <p>Overwrites a file stream with zero values.</p>
        </li>
        <li>
            <code>OverwriteWithAlternatingPattern(FileStream stream, long fileSize)</code>
            <p>Overwrites a file stream with an alternating pattern of 0xFF and 0x00.</p>
        </li>
        <li>
            <code>OverwriteWithEncryptedRandomData(FileStream stream, long fileSize)</code>
            <p>Overwrites a file stream with encrypted random data.</p>
        </li>
    </ul>

    <h3>Class: CommandLineArguments</h3>
    <p>A helper class for parsing and managing command-line arguments.</p>

    <h4>Methods</h4>
    <ul>
        <li>
            <code>AddParameter(string name, string value)</code>
            <p>Adds a parameter with the specified name and value.</p>
        </li>
        <li>
            <code>ContainsParameter(string name)</code>
            <p>Checks if the specified parameter exists.</p>
        </li>
        <li>
            <code>GetValue&lt;T&gt;(string name)</code>
            <p>Retrieves the value of the specified parameter and converts it to the specified type.</p>
        </li>
        <li>
            <code>RemoveParameter(string name)</code>
            <p>Removes the specified parameter.</p>
        </li>
    </ul>

</body>
</html>
